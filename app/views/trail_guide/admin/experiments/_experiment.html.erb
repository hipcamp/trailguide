<div class="row justify-content-center">
  <div class="col-sm-12 col-md-10 col-lg-8">
    <h3><%= experiment.experiment_name.to_s.humanize.titleize %></h3>

    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <td>
            <% if experiment.started? %>
              <%= link_to "stop", trail_guide_admin.stop_experiment_path(experiment.experiment_name), class: 'btn btn-sm btn-warning', method: :put %>
              <%= link_to "restart", trail_guide_admin.restart_experiment_path(experiment.experiment_name), class: 'btn btn-sm btn-danger',method: :put %>
            <% else %>
              <%= link_to "start", trail_guide_admin.start_experiment_path(experiment.experiment_name), class: 'btn btn-sm btn-success',method: :put %>
            <% end %>
            <%= link_to "reset", trail_guide_admin.reset_experiment_path(experiment.experiment_name), class: 'btn btn-sm btn-danger',method: :put %>
          </td>

          <th scope="col">Participants</th>

          <% if experiment.goals.empty? %>
            <th scope="col">Converted</th>
          <% else %>
            <% experiment.goals.each do |goal| %>
              <th scope="col"><%= goal.to_s.humanize.titleize %></th>
            <% end %>
          <% end %>

          <th>&nbsp;</th>
        </tr>
      </thead>

      <tbody>
        <% experiment.variants.each do |variant| %>
          <tr>
            <th scope="row"><%= variant.name.to_s.humanize.titleize %></th>

            <td><%= variant.participants %></td>

            <% if experiment.goals.empty? %>
              <td><%= variant.converted %></td>
            <% else %>
              <% experiment.goals.each do |goal| %>
                <td><%= variant.converted(goal) %></td>
              <% end %>
            <% end %>

            <td>
              <% if experiment.winner? && variant == experiment.winner %>
                <span class="badge badge-primary">winner</span>
              <% else %>
                <%= link_to "use this", trail_guide_admin.winner_experiment_path(experiment.experiment_name, variant.name), class: 'btn btn-sm btn-secondary', method: :put %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>

      <tfoot>
        <tr class="table-secondary">
          <th scope="row">&nbsp;</th>
          <td><%= experiment.variants.sum(&:participants) %></td>
          <% if experiment.goals.empty? %>
            <td><%= experiment.variants.sum(&:converted) %></td>
          <% else %>
            <% experiment.goals.each do |goal| %>
              <td><%= experiment.variants.sum { |var| var.converted(goal) } %></td>
            <% end %>
          <% end %>
          <td>&nbsp;</td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>
